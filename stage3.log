
======================================
SETUP
======================================

[14:43:43] Using base URL: http://localhost:8000
[14:43:43] Waiting for: orchestrator health endpoint (timeout 60s)
[0;32m[14:43:49] âœ“ Condition met after 0s[0m
[0;32m[14:43:54] âœ“ Health endpoint reports healthy (expected=healthy, actual=healthy)[0m

======================================
STAGE 3: DOCUMENTS + RAG
======================================

[14:43:54] Running test: doc_upload
[14:44:07] Document ingestion request succeeded (document_id=29dd87df-e8c2-42af-bfbb-ee7edf67e70a job_id=85d850ad-a5ab-4370-94c3-73a3f737b5d5)
[14:44:07] Waiting for: document ingestion completion (timeout 180s)
[0;32m[14:44:07] âœ“ Condition met after 0s[0m
[0;32m[14:44:07] âœ“ Document uploaded[0m
[0;32m[14:44:07] âœ“ doc_upload passed (13s)[0m
[14:44:07] Running test: doc_job_created
[0;32m[14:44:07] âœ“ Job created for document[0m
[0;32m[14:44:07] âœ“ doc_job_created passed (0s)[0m
[14:44:07] Running test: doc_job_completed
[0;32m[14:44:07] âœ“ Document job completed[0m
[0;32m[14:44:07] âœ“ doc_job_completed passed (0s)[0m
[14:44:07] Running test: doc_status_indexed
[0;32m[14:44:08] âœ“ Document status indexed (expected=indexed, actual=indexed)[0m
[0;32m[14:44:08] âœ“ doc_status_indexed passed (1s)[0m
[14:44:08] Running test: doc_chunks_created
[0;32m[14:44:09] âœ“ Chunks created (1 > 0)[0m
[0;32m[14:44:09] âœ“ doc_chunks_created passed (1s)[0m
[14:44:09] Running test: doc_chunk_ordinals
[0;32m[14:44:10] âœ“ Chunk ordinals sequential (expected=0, actual=0)[0m
[0;32m[14:44:10] âœ“ doc_chunk_ordinals passed (1s)[0m
[14:44:10] Running test: doc_chunk_tokens
[0;32m[14:44:10] âœ“ Chunk token counts recorded (1 > 0)[0m
[0;32m[14:44:10] âœ“ doc_chunk_tokens passed (0s)[0m
[14:44:10] Running test: doc_chunk_metadata
[0;32m[14:44:11] âœ“ Chunk metadata includes pages (1 > 0)[0m
[0;32m[14:44:11] âœ“ doc_chunk_metadata passed (1s)[0m
[14:44:11] Running test: doc_vectors
[0;32m[14:44:11] âœ“ Vectors exist for document (1 > 0)[0m
[0;32m[14:44:11] âœ“ doc_vectors passed (0s)[0m
[14:44:11] Running test: doc_vector_payload_fields
[0;32m[14:44:11] âœ“ Vector payload contains embedding_model[0m
[0;32m[14:44:11] âœ“ doc_vector_payload_fields passed (0s)[0m
[14:44:11] Running test: doc_search_keyword
[0;32m[14:44:12] âœ“ Keyword search HTTP 200[0m
[0;32m[14:44:12] âœ“ Keyword search finds document[0m
[0;32m[14:44:12] âœ“ doc_search_keyword passed (1s)[0m
[14:44:12] Running test: doc_search_semantic
[0;32m[14:44:12] âœ“ Semantic search HTTP 200[0m
[0;32m[14:44:12] âœ“ Semantic search returns document[0m
[0;32m[14:44:12] âœ“ doc_search_semantic passed (0s)[0m
[14:44:12] Running test: doc_search_filter
[0;32m[14:44:12] âœ“ Search filter HTTP 200[0m
[0;32m[14:44:12] âœ“ Search filter for document chunks (10 > 0)[0m
[0;32m[14:44:12] âœ“ doc_search_filter passed (0s)[0m
[14:44:12] Running test: doc_rag_answer
[0;32m[14:44:20] âœ“ RAG chat request[0m
[0;32m[14:44:20] âœ“ doc_rag_answer passed (7s)[0m
[14:44:20] Running test: doc_rag_citations
[0;32m[14:44:20] âœ“ RAG citations present (5 > 0)[0m
[0;32m[14:44:21] âœ“ doc_rag_citations passed (0s)[0m
[14:44:21] Running test: doc_deduplication
[0;32m[14:44:21] âœ“ Duplicate upload flagged (expected=true, actual=true)[0m
[0;32m[14:44:21] âœ“ doc_deduplication passed (0s)[0m
[14:44:21] Running test: doc_large_file_rejected
[0;32m[14:44:21] âœ“ Large file rejected[0m
[0;32m[14:44:22] âœ“ doc_large_file_rejected passed (1s)[0m
[14:44:22] Running test: doc_unsupported_type
[0;32m[14:44:22] âœ“ Unsupported mime rejected[0m
[0;32m[14:44:22] âœ“ doc_unsupported_type passed (0s)[0m
[14:44:22] Running test: doc_processing_speed_small
[0;32m[14:44:22] âœ“ 5-page PDF processed under 30s (0.064289 < 30)[0m
[0;32m[14:44:23] âœ“ doc_processing_speed_small passed (0s)[0m
[14:44:23] Running test: doc_processing_speed_large
[1;33m[14:44:23] âš  fpdf not available, creating minimal PDF instead[0m
[0;32m[14:44:23] âœ“ doc_processing_speed_large passed (0s)[0m
[14:44:23] Running test: doc_list_endpoint
[0;32m[14:44:23] âœ“ List documents endpoint[0m
[0;32m[14:44:23] âœ“ doc_list_endpoint passed (0s)[0m
[14:44:23] Running test: doc_detail_endpoint
[0;32m[14:44:23] âœ“ Document detail endpoint[0m
[0;32m[14:44:23] âœ“ doc_detail_endpoint passed (0s)[0m
[14:44:23] Running test: doc_chunks_endpoint
[0;32m[14:44:23] âœ“ Document chunks endpoint[0m
[0;32m[14:44:23] âœ“ doc_chunks_endpoint passed (0s)[0m
[14:44:24] Running test: doc_delete_endpoint
[0;32m[14:44:24] âœ“ Delete document endpoint[0m
[0;32m[14:44:24] âœ“ doc_delete_endpoint passed (0s)[0m
[14:44:24] Running test: doc_delete_vectors
[0;32m[14:44:25] âœ“ Vectors removed after delete (expected=0, actual=0)[0m
[0;32m[14:44:25] âœ“ doc_delete_vectors passed (1s)[0m
[14:44:25] Running test: doc_corrupted_pdf
[0;32m[14:44:26] âœ“ Corrupted PDF job failed (expected=failed, actual=failed)[0m
[0;32m[14:44:26] âœ“ doc_corrupted_pdf passed (1s)[0m
[14:44:26] Running test: doc_job_error
[0;32m[14:44:27] âœ“ Failed job error message populated[0m
[0;32m[14:44:27] âœ“ doc_job_error passed (1s)[0m
[14:44:27] Running test: doc_concurrent_uploads
[1;33m[14:44:27] âš  fpdf not available, creating minimal PDF instead[0m
[1;33m[14:44:27] âš  fpdf not available, creating minimal PDF instead[0m
[1;33m[14:44:27] âš  fpdf not available, creating minimal PDF instead[0m
[0;32m[14:44:27] âœ“ Concurrent uploads succeed (expected=0, actual=0)[0m
[0;32m[14:44:27] âœ“ doc_concurrent_uploads passed (0s)[0m
[14:44:27] Running test: doc_search_latency
* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
* using HTTP/1.x
> GET /api/v1/search?q=document HTTP/1.1
> Host: localhost:8000
> User-Agent: curl/8.12.1
> Accept: */*
> Authorization: Bearer e1f8c9a2b3d4e5f6a7b8c9d0e1f2a3b4
> 
* Request completely sent off
< HTTP/1.1 200 OK
< date: Fri, 14 Nov 2025 14:44:27 GMT
< server: uvicorn
< content-length: 5563
< content-type: application/json
< 
* Connection #0 to host localhost left intact
* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
* using HTTP/1.x
> GET /api/v1/search?q=document HTTP/1.1
> Host: localhost:8000
> User-Agent: curl/8.12.1
> Accept: */*
> Authorization: Bearer e1f8c9a2b3d4e5f6a7b8c9d0e1f2a3b4
> 
* Request completely sent off
< HTTP/1.1 200 OK
< date: Fri, 14 Nov 2025 14:44:28 GMT
< server: uvicorn
< content-length: 5563
< content-type: application/json
< 
* Connection #0 to host localhost left intact
* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
* using HTTP/1.x
> GET /api/v1/search?q=document HTTP/1.1
> Host: localhost:8000
> User-Agent: curl/8.12.1
> Accept: */*
> Authorization: Bearer e1f8c9a2b3d4e5f6a7b8c9d0e1f2a3b4
> 
* Request completely sent off
< HTTP/1.1 200 OK
< date: Fri, 14 Nov 2025 14:44:28 GMT
< server: uvicorn
< content-length: 5563
< content-type: application/json
< 
* Connection #0 to host localhost left intact
* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
* using HTTP/1.x
> GET /api/v1/search?q=document HTTP/1.1
> Host: localhost:8000
> User-Agent: curl/8.12.1
> Accept: */*
> Authorization: Bearer e1f8c9a2b3d4e5f6a7b8c9d0e1f2a3b4
> 
* Request completely sent off
< HTTP/1.1 200 OK
< date: Fri, 14 Nov 2025 14:44:28 GMT
< server: uvicorn
< content-length: 5563
< content-type: application/json
< 
* Connection #0 to host localhost left intact
* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
* using HTTP/1.x
> GET /api/v1/search?q=document HTTP/1.1
> Host: localhost:8000
> User-Agent: curl/8.12.1
> Accept: */*
> Authorization: Bearer e1f8c9a2b3d4e5f6a7b8c9d0e1f2a3b4
> 
* Request completely sent off
< HTTP/1.1 200 OK
< date: Fri, 14 Nov 2025 14:44:29 GMT
< server: uvicorn
< content-length: 5563
< content-type: application/json
< 
* Connection #0 to host localhost left intact
[0;32m[14:44:29] âœ“ Search latency under threshold (178 < 200)[0m
[0;32m[14:44:29] âœ“ doc_search_latency passed (2s)[0m
[14:44:29] Running test: doc_metrics_counters
[0;32m[14:44:34] âœ“ documents_ingested_total metric defined (expected=1, actual=1)[0m
[0;32m[14:44:37] âœ“ rag_queries_total increments (2.0 > 1.0)[0m
[0;32m[14:44:37] âœ“ doc_metrics_counters passed (8s)[0m

======================================
TEST SUMMARY
======================================

Total Tests: 30
Passed: 30
Failed: 0
Warnings: 1
Duration: 0m 54s
Pass Rate: 100.0%

SLO Status:
  - Reminder fire lag p95: unavailable
  - Push success rate: unavailable
  - Document ingestion p95: unavailable
  - Vector search p95: 178ms (target < 200ms)

Logs: /tmp/vib-test-20251114-174343/run.log
Artifacts: /tmp/vib-test-20251114-174343
[14:44:37] JSON report: /tmp/vib-test-20251114-174343/results.json
[14:44:37] Cleaning up test data...
[0;32m[14:44:40] âœ“ Cleanup complete[0m
