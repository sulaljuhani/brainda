
======================================
SETUP
======================================

[14:26:10] Using base URL: http://localhost:8000
[14:26:10] Waiting for: orchestrator health endpoint (timeout 60s)
[0;32m[14:26:15] âœ“ Condition met after 0s[0m
[0;32m[14:26:20] âœ“ Health endpoint reports healthy (expected=healthy, actual=healthy)[0m

======================================
STAGE 2: REMINDERS + NOTIFICATIONS
======================================

[14:26:20] Running test: reminder_api_create
[0;32m[14:26:20] âœ“ Reminder created via API[0m
[0;32m[14:26:20] âœ“ reminder_api_create passed (0s)[0m
[14:26:20] Running test: reminder_db_record
[0;32m[14:26:21] âœ“ Reminder persisted in DB (expected=1, actual=1)[0m
[0;32m[14:26:21] âœ“ reminder_db_record passed (1s)[0m
[14:26:21] Running test: reminder_scheduler_entry
[0;32m[14:26:22] âœ“ Reminder 845778e0-0c72-47ac-93e5-4ad2695304a7 scheduled in APScheduler[0m
[0;32m[14:26:22] âœ“ reminder_scheduler_entry passed (1s)[0m
[14:26:22] Running test: reminder_chat_flow
[0;32m[14:26:23] âœ“ Chat endpoint accepted reminder request[0m
[0;32m[14:26:23] âœ“ reminder_chat_flow passed (1s)[0m
[14:26:23] Running test: reminder_smart_defaults
[0;32m[14:26:23] âœ“ Chat request for smart defaults[0m
[0;32m[14:26:28] âœ“ Reminder created via chat[0m
[0;32m[14:26:29] âœ“ Smart default produced local time 09:00:00[0m
[0;32m[14:26:29] âœ“ reminder_smart_defaults passed (6s)[0m
[14:26:29] Running test: reminder_dedup_response
[0;32m[14:26:29] âœ“ Duplicate reminder flagged (expected=true, actual=true)[0m
[0;32m[14:26:29] âœ“ reminder_dedup_response passed (0s)[0m
[14:26:30] Running test: reminder_dedup_constraint
[0;32m[14:26:30] âœ“ Database prevented duplicate reminder[0m
[0;32m[14:26:30] âœ“ reminder_dedup_constraint passed (0s)[0m
[14:26:30] Running test: reminder_timezone
[0;32m[14:26:31] âœ“ Timezone stored correctly (expected=America/Los_Angeles, actual=America/Los_Angeles)[0m
[0;32m[14:26:31] âœ“ reminder_timezone passed (1s)[0m
[14:26:31] Running test: reminder_due_local
[0;32m[14:26:31] âœ“ due_at_local preserved (expected=14:56:00, actual=14:56:00)[0m
[0;32m[14:26:32] âœ“ reminder_due_local passed (1s)[0m
[14:26:32] Running test: reminder_snooze_updates
[0;32m[14:26:33] âœ“ Snooze returned due_at[0m
[0;32m[14:26:33] âœ“ reminder_snooze_updates passed (1s)[0m
[14:26:33] Running test: reminder_snooze_logs
[0;32m[14:26:34] âœ“ Snooze reschedule logged[0m
[0;32m[14:26:34] âœ“ reminder_snooze_logs passed (1s)[0m
[14:26:34] Running test: reminder_cancel_endpoint
[0;32m[14:26:35] âœ“ Cancel endpoint[0m
[0;32m[14:26:35] âœ“ reminder_cancel_endpoint passed (1s)[0m
[14:26:35] Running test: reminder_cancel_state
[1;33m[14:26:36] âš  Base reminder not cancelled; cancelling now[0m
[0;32m[14:26:36] âœ“ Reminder marked cancelled (expected=cancelled, actual=cancelled)[0m
[0;32m[14:26:36] âœ“ reminder_cancel_state passed (1s)[0m
[14:26:36] Running test: reminder_recurring_daily
[0;32m[14:26:41] âœ“ Daily recurrence saved (expected=FREQ=DAILY, actual=FREQ=DAILY)[0m
[0;32m[14:26:42] âœ“ reminder_recurring_daily passed (5s)[0m
[14:26:42] Running test: reminder_recurring_weekly
[0;32m[14:26:42] âœ“ Weekly recurrence saved (expected=FREQ=WEEKLY;BYDAY=MO, actual=FREQ=WEEKLY;BYDAY=MO)[0m
[0;32m[14:26:42] âœ“ reminder_recurring_weekly passed (0s)[0m
[14:26:42] Running test: reminder_recurring_monthly
[0;32m[14:26:43] âœ“ Monthly recurrence saved (expected=FREQ=MONTHLY;BYMONTHDAY=1, actual=FREQ=MONTHLY;BYMONTHDAY=1)[0m
[0;32m[14:26:43] âœ“ reminder_recurring_monthly passed (1s)[0m
[14:26:43] Running test: device_registration
[0;32m[14:26:44] âœ“ Device registered[0m
[0;32m[14:26:44] âœ“ device_registration passed (1s)[0m
[14:26:44] Running test: device_db_entry
[0;32m[14:26:44] âœ“ Device row exists (expected=1, actual=1)[0m
[0;32m[14:26:44] âœ“ device_db_entry passed (0s)[0m
[14:26:44] Running test: device_test_notification
[0;32m[14:26:44] âœ“ Test notification endpoint[0m
[0;32m[14:26:44] âœ“ device_test_notification passed (0s)[0m
[14:26:44] Running test: push_metrics
[1;33m[14:26:45] âš  Push delivery metrics have no samples[0m
[0;32m[14:26:45] âœ“ push_metrics passed (1s)[0m
[14:26:45] Running test: reminder_fire_slo
[14:26:45] Waiting for reminder 01495e1b-050b-41c0-a0a1-42e1134a0bb2 to fire (up to 150s)
[14:26:45] Waiting for: notification delivery for 01495e1b-050b-41c0-a0a1-42e1134a0bb2 (timeout 150s)
[0;32m[14:27:00] âœ“ Condition met after 9s[0m
[0;32m[14:27:01] âœ“ Reminder fire lag <5 s (0.062686 < 5)[0m
[0;32m[14:27:01] âœ“ reminder_fire_slo passed (16s)[0m
[14:27:01] Running test: notification_delivery_record
[0;32m[14:27:02] âœ“ Notification delivery recorded (expected=delivered, actual=delivered)[0m
[0;32m[14:27:02] âœ“ notification_delivery_record passed (1s)[0m
[14:27:02] Running test: reminder_metrics_created
[0;32m[14:27:02] âœ“ reminders_created_total increments (13 > 12)[0m
[0;32m[14:27:02] âœ“ reminder_metrics_created passed (0s)[0m
[14:27:02] Running test: reminder_metrics_deduped
[0;32m[14:27:03] âœ“ reminders_deduped_total increments (3 > 2)[0m
[0;32m[14:27:03] âœ“ reminder_metrics_deduped passed (1s)[0m
[14:27:03] Running test: reminder_metrics_fire_lag
[1;33m[14:27:03] âš  Reminder fire lag histogram has no samples[0m
[0;32m[14:27:03] âœ“ reminder_metrics_fire_lag passed (0s)[0m
[14:27:03] Running test: reminder_list_endpoint
[0;32m[14:27:03] âœ“ List reminders endpoint[0m
[0;32m[14:27:04] âœ“ reminder_list_endpoint passed (1s)[0m
[14:27:04] Running test: reminder_update_endpoint
[0;32m[14:27:04] âœ“ Reminder update endpoint[0m
[0;32m[14:27:04] âœ“ reminder_update_endpoint passed (0s)[0m
[14:27:04] Running test: reminder_restart_persistence
[14:27:08] Waiting for: health after orchestrator restart (timeout 60s)
curl: (52) Empty reply from server
[0;32m[14:27:14] âœ“ Condition met after 1s[0m
[0;32m[14:27:15] âœ“ Reminder still available post-restart (expected=28302cec-6b95-4312-afa4-98c5b4ac1a27, actual=28302cec-6b95-4312-afa4-98c5b4ac1a27)[0m
[0;32m[14:27:15] âœ“ reminder_restart_persistence passed (11s)[0m

======================================
TEST SUMMARY
======================================

Total Tests: 28
Passed: 28
Failed: 0
Warnings: 3
Duration: 1m 6s
Pass Rate: 100.0%

SLO Status:
  - Reminder fire lag p95: nans (target < 5s)
  - Push success rate: unavailable
  - Document ingestion p95: unavailable
  - Vector search p95: unavailable

Logs: /tmp/vib-test-20251114-172609/run.log
Artifacts: /tmp/vib-test-20251114-172609
[14:27:15] JSON report: /tmp/vib-test-20251114-172609/results.json
[14:27:15] Cleaning up test data...
[0;32m[14:27:18] âœ“ Cleanup complete[0m
